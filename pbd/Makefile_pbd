# general variables
hpip_root = @HPIP_ROOT@

# force_look
force_look = force_look

# the main target is the promoter-barcode dictionary (pbd)
pbd = pbd.txt
pbd_raw = $(pbd).raw

# intermediate targets: the starcoded promoters
libs_dir = pbd_libs
libs = $(libs_dir)/HPIP_bcds_A1toA12 \
       $(libs_dir)/HPIP_bcds_B1toB12 \
       $(libs_dir)/HPIP_bcds_C1toC12 \
       $(libs_dir)/HPIP_bcds_D1toD12 \
       $(libs_dir)/HPIP_bcds_E1toE12 \
       $(libs_dir)/HPIP_bcds_F1toF12 \
       $(libs_dir)/HPIP_bcds_G1toG12 \
       $(libs_dir)/HPIP_bcds_H1toH12

# generate promoter-barcode dictionary script and log
generate_pbd = @HPIP_ROOT@/hpipline/pbd/generate_pbd.py
generate_pbd_log = generate_pbd.log

all : $(pbd)

$(pbd_raw) : $(libs) $(generate_pbd)
	python $(generate_pbd) $(hpip_root)

$(pbd) : $(pbd_raw)
	sort $^ > $@

$(libs) : $(force_look)
	$(MAKE) -C $@ $(MAKECMDGOALS)

$(force_look) :
	@true
